@model MVC.Models.tblemp

@{
    ViewData["Title"] = "Update Employee";
}

<h2>@ViewData["Title"]</h2>

<form id="employeeForm">
    <label for="name">Name:</label>
    <input type="text" id="name" name="c_empname" class="k-textbox" value="@Model.c_empname" /><br>

    <label for="gender">Gender:</label>
    <input type="radio" id="male" name="c_gender" value="Male" class="k-radio" checked="@Model.c_gender == 'Male'" />
    <label for="male" class="k-radio-label">Male</label>
    <input type="radio" id="female" name="c_gender" value="Female" class="k-radio" checked="@Model.c_gender == 'Female'" />
    <label for="female" class="k-radio-label">Female</label>

    <div>
        Shift:
        <input type="checkbox" id="c_shiftMorning" name="c_shift" value="Morning" class="k-checkbox" @(Model.c_shift.Contains("Morning") ? "checked" : "") />
        <label for="morningShift" class="k-checkbox-label">Morning</label>
        <input type="checkbox" id="c_shiftNight" name="c_shift" value="Night" class="k-checkbox" @(Model.c_shift.Contains("Night") ? "checked" : "") />
        <label for="nightShift" class="k-checkbox-label">Night</label>
    </div>
    <div>
        <label for="c_depid">Department:</label>
        
            <select id="departmentList" name="c_depid"></select><br>
        
        
    </div>
    <div>
        <label for="c_dob">Date of Joining:</label>
        <input type="date" id="c_dob" name="c_dob" class="k-datepicker" style="width: 100%;" value="@Model.c_dob.ToString("yyyy-MM-dd")" />
    </div>
    <div>
        <label for="ImageFile">Employee Image:</label>
        <input type="file" id="ImageFile" name="file" class="k-upload"/><br />
        @if (!string.IsNullOrEmpty(Model.c_empimage))
        {
            <img src="@Url.Content("~/images/" + Model.c_empimage)" alt="Employee Image" style="max-width: 200px;" />
        }
    </div>
    </div>

    <button type="button" id="saveButton" name="saveButton" class="k-button k-primary">Update</button>
</form>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
@section Scripts {
    <script>
        $(document).ready(function () {
            // Fetch departments and set the selected value
            $.ajax({
                url: "https://localhost:7028/kendoempcomponent/GetDeptName",
                type: "GET",
                success: function (data) {
                    var departments = data;
                    var $dropdown = $("#departmentList");
            
                    // Clear existing options
                    $dropdown.empty();

                    // Add option for each department
                    $.each(departments, function (index, department) {
                        $dropdown.append($("<option></option>")
                            .attr("value", department.c_depid)
                            .text(department.c_dename));
                    });

                    // Set selected value
                    $dropdown.val("@Model.c_depid");
                },
                error: function (xhr, status, error) {
                    console.log(error);
                }
            });

            // Initialize the date picker
            //$("#c_dob").kendoDatePicker();

            // Handle the click event of the save button
            $("#saveButton").click(function () {
                var formData = new FormData($("#employeeForm")[0]);
                $.ajax({
                    url: "https://localhost:7028/kendoempcomponent/update/" ,
                    type: "POST",
                    data: formData,
                    processData: false,
                    contentType: false,
                    success: function (response) {
                        console.log(response);
                        window.location.href = "https://localhost:7028/kendoempcomponent/Index";
                    },
                    error: function (xhr, status, error) {
                        console.log(error);
                    }
                });
            });
        });
    </script>
}
